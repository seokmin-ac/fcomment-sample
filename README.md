# fcomment-sample

[![Netlify Status](https://api.netlify.com/api/v1/badges/03c6b834-d4f6-4381-9ce8-73b4eac54a04/deploy-status)](https://app.netlify.com/sites/fcomment-sample/deploys)

This blog is just a fork project of [gatsby-blog-starter](https://www.gatsbyjs.com/starters/gatsbyjs/gatsby-starter-blog). Some authorization logics are implemented for showing how fcomment works.

[Working Demo](https://fcomment-sample.netlify.app/)

## Installation

```shell
git clone https://github.com/seokmin-ac/fcomment-sample
cd fcomment-sample
npm install
```

## Prerequisites

- [Auth0](https://auth0.com/) SPA application and API
- Deployed [fcomment](https://github.com/seokmin-ac/fcomment) project

## Local Development

1. Create `.env` file to root directory of the project. Local environment variables would be provided by `.env` file with `node-env-run` package.

   ```
   # .env
   GATSBY_DOMAIN="XXXXXX.auth0.com"
   GATSBY_CLIENT_ID="XXXXXXX"
   GATSBY_AUDIENCE="XXXXXX"
   ...
   ```

2. Serve the site for local development.

   ```shell
   npm start
   ```

## Netlify Deployment

1. Click following button.

   [![Deploy to Netlify](https://www.netlify.com/img/deploy/button.svg)](https://app.netlify.com/start/deploy?repository=https://github.com/seokmin-ac/fcomment-sample#GATSBY_DOMAIN=YOUR_AUTH0_DOMAIN&GATSBY_CLIENT_ID=YOUR_AUTH0_CLIENT_ID&GATSBY_AUDIENCE=YOUR_AUTH0_AUDIENCE&GATSBY_API_ID=YOUR_AUTH0_API_ID&GATSBY_API_SECRET=YOUR_API_SECRET&GATSBY_API_DOMAIN=YOUR_DEPLOYED_FCOMMENT_DOMAIN)

2. Edit environment variables from `Settings` > `Build & Deploy` > `Environment` menu of Netlify dashboard.

## Environment Variables

- **GATSBY_DOMAIN**: Your Auth0 domain. ex: `"xxx.us.auth0.com"`
- **GATSBY_CLIENT_ID**: Your client ID of Auth0 application.
- **GATSBY_AUDIENCE**: Your Auth0 audience. It is an identifier of your Auth0 API.
- **GATSBY_API_ID**: Your client ID of Auth0 application generated by Auth0 API.
- **GATSBY_API_SECRET**: Your secret of Auth0 application generated by Auth0 API.
- **GATSBY_API_DOMAIN**: Your deployed fcomment domain. It should contains protocol(`https://` or `http://`). If you are just developing at local, you can use this value as `http://localhost:[FLASK_PORT]`.
- **GATSBY_ACCESS_TOKEN** (local-only): If you are developing at local, you can cache Auth0 API client credential key at this variable. This project request to Auth0 to assign new key when it generates pages, but there is 1,000 limit for API token generation for Auth0 API.
